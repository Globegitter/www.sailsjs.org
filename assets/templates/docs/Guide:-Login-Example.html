<div class="docs Guide:-Login-Example">
<blockquote>
<p><em>Note: You are viewing the Sails.js v0.9.0 documentation.  If you&#39;re looking for information on v0.8.x, please visit <a href="http://08x.sailsjs.org">here</a>.</em></p>
</blockquote>
<p>This example uses the <a href="https://github.com/ncb000gt/node.bcrypt.js">bcrypt</a> module to securely encrypt and compare passwords.
By default, the login action would be triggered in response to requests for /session/login; this behavior can be configured using <a href="https://github.com/balderdashy/sails/wiki/routes">custom routes</a>.</p>
<pre><code class="lang-javascript">/*---------------------
  :: Session 
    -&gt; controller
---------------------*/
var bcrypt = require(&#39;bcrypt&#39;);

var SessionController = {

    login: function(req, res) {

        // Get password and username from request
        var username = req.param(&#39;username&#39;);
        var password = req.param(&#39;password&#39;);

        // No username/password entered
        if(!(username &amp;&amp; password)) {
            return res.send(&#39;No username or password specified!&#39;, 500);
        }
        // Lookup the user in the database
        User.findOne({
            username: username
        }).exec(function (err, user) {

            // Account not found
            if (err || !user) {
                return res.send(&#39;Invalid username and password combination!&#39;, 500);
            }

            // Compare the passwords
            bcrypt.compare(password, user.password, function(err, valid) {
                if(err || !valid)
                    return res.send(&#39;Invalid username and password combination!&#39;, 500)

                // The user has authenticated successfully, set their session
                req.session.authenticated = true;
                req.session.User = user;

                // Redirect to protected area
                return res.redirect(&#39;/dashboard&#39;);
            });
        });
    },

    register: function(req, res){
        var username = req.param(&#39;username&#39;);
        var password = req.param(&#39;password&#39;);
        var confirm = req.param(&#39;password-confirm&#39;);

        // Make sure user has filled out the form correctly
        if (!username || !password || !confirm || password !== confirm) {
            return res.send(&#39;Please fill in all required fields&#39;, 500);
        }

        // Hash the password
        bcrypt.hash(password, 10, function(err, hash) {
            if (err) return res.send(&#39;An error occured&#39;, 500);

            // Save user to the database
            User.create({
               username: username,
               password: hash
            }).exec(function(err, user){
                if (err) return res.send(&#39;An error occured&#39;, 500);

                // TODO: add email verification process
                req.session.authenticated = true;
                req.session.User = user;

                // Redirect to protected area
                return res.redirect(&#39;/dashboard&#39;);
            })

        });
    }
};
module.exports = SessionController;</code></pre>
<p><a href="http://githalytics.com/balderdashy/sails/wiki/loginExample"><img src="https://cruel-carlota.pagodabox.com/8acf2fc2ca0aca8a3018e355ad776ed7" alt="githalytics.com alpha" title="githalytics.com"></a></p>

</div>